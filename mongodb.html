<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>MongoDB Notes</title>

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code&family=Inter:wght@400;600&display=swap"
        rel="stylesheet" />

    <style>
        /* Reset & Global */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: 'Inter', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f2f2f2;
            color: #212121;
            line-height: 1.8;
            display: flex;
            min-height: 100vh;
        }

        /* Sidebar */
        .sidebar {
            position: fixed;
            top: 0;
            left: 0;
            width: 250px;
            height: 100vh;
            background: linear-gradient(180deg, #1a1a1a, #333);
            color: #fff;
            padding: 25px 18px;
            overflow-y: auto;
            box-shadow: 2px 0 8px rgba(0, 0, 0, 0.2);
            z-index: 999;
        }

        .sidebar ul {
            list-style: none !important;
        }

        .sidebar li {
            margin: 18px 0;
        }

        .sidebar a {
            color: #fff;
            text-decoration: none;
            font-size: 1.15rem;
            display: block;
            padding: 10px 18px;
            border-radius: 6px;
            font-weight: 500;
            transition: background-color 0.3s, box-shadow 0.3s;
        }

        .sidebar a:hover {
            background-color: #43a047;
            box-shadow: 2px 2px 8px rgba(0, 0, 0, 0.2);
            color: #e8f5e9;
        }


        /* navbar */
        .navbar{
            position: fixed;
            display: flex;
            justify-content: space-around;
            width: calc(100vw - 260px);
            margin-left: 250px;
            height: 50px;
            background-color: #282c34;
        }

        .navelement{
            border-left: 2px solid gray;
            width: 200px;
            display: flex;
            justify-content: center;
            align-items: center;
            text-decoration: none;
        }


        /* Main Content */
        main {
            margin-left: 260px;
            margin-top: 40px;
            padding: 30px 40px;
            width: calc(100% - 260px);
            background-color: #f2f2f2;
        }

        /* Note Section Container */
        .note-section {
            background-color: #fff;
            padding: 30px 25px;
            border-radius: 12px;
            box-shadow: 0 3px 12px rgba(0, 0, 0, 0.5);
            margin-bottom: 30px;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        /* .note-section:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 24px rgba(0, 0, 0, 0.12);
        } */

        /* .container {
            max-width: 1100px;
            margin: 0 auto;
        } */

        /* Level 1 Notes */
        .note-l1 {
            margin-bottom: 30px;
            width: 100%;
        }

        .note-l1 h2 {
            font-size: 2rem;
            font-weight: 700;
            text-align: center;
            color: #2e7d32;
            background-color: #e8f5e9;
            padding: 5px 18px;
            border-left: 5px solid #2e7d32;
            border-radius: 5px;
            /* position: sticky; */
            /* top: 0; */
            /* z-index: 10; */
        }

        .note-l1>p {
            font-size: 1.3rem;
            color: #202020;
            margin-top: 15px;
            margin-bottom: 20px;
        }

        /* Notes Grid */
        /* .notes {
            display: grid;
            //grid-template-columns: repeat(auto-fill, minmax(360px, 1fr));
            gap: 22px;
            margin-top: 25px;
        } */

        /* Level 2 Notes */
        .note-l2 {
            background-color: #ffffff;
            padding: 22px 20px;
            margin-top: 15px;
            margin-bottom: 30px;
            border-top: 4px solid #0288d1;
            border-radius: 10px;
            width: 100%;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.5);
            transition: box-shadow 0.3s ease, transform 0.3s ease;
        }

        /* .note-l2:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 18px rgba(0, 0, 0, 0.12);
        } */

        .note-l2 h3 {
            font-size: 1.6rem;
            font-weight: 600;
            color: #014f86;
            margin-bottom: 8px;
        }

        .note-l2 p {
            font-size: 1.15rem;
            color: #2e2e2e;
            margin-bottom: 18px;
            margin-top: 20px;
        }

        /* Level 3 Notes */
        .note-l3 {
            background-color: #f9f9f9;
            padding: 16px 14px;
            /* margin: 18px 0 18px 10px; */
            margin-top: 20px;
            border-left: 5px solid #7b1fa2;
            border-radius: 7px;
            width: 100%;
            box-shadow: 0 1px 6px rgba(0, 0, 0, 0.3);
        }

        .note-l3 h4 {
            font-size: 1.3rem;
            font-weight: 500;
            color: #4a148c;
            margin-bottom: 10px;
        }

        .note-l3 p {
            font-size: 1.15rem;
            color: #313131;
        }

        /* Code Section Style */
        .code-container {
            background-color: #272822;
            padding: 15px 20px;
            /* border-left: 5px solid #66d9ef; */
            border-radius: 8px;
            overflow-x: auto;
            /* margin: 15px 0 10px; */
            margin-top: 20px;
            width: 100%;
            display: inline-block;
            text-align: left;
        }

        .code-container code {
            color: #f8f8f2;
            font-size: 16px;
            font-family: monospace;
            white-space: pre-line;
            display: block;
            line-height: 2rem;
            margin: 0;
            padding: 0;
        }

        .code-container code::first-line {
            line-height: 0;
        }

        /* Table Styles */
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 25px 0;
            font-size: 1rem;
            color: #333;
        }

        table,
        th,
        td {
            border: 3px solid #858080;
            padding: 14px 16px;
        }

        th {
            background-color: #f0f0f0;
            font-weight: 700;
            color: #222;
        }

        caption {
            font-size: 1.25rem;
            margin-bottom: 12px;
            font-weight: 600;
            color: #2e7d32;
        }

        .bolder {
            font-weight: 700;
        }

        /* lists ul, ol */
        ul:not(.sidebar ul),
        ol:not(.sidebar ol) {
            padding-left: 25px;
            margin-bottom: 20px;
            color: #444;
            font-size: 1.2rem;
        }

        ul:not(.sidebar)li {
            margin-bottom: 10px;
        }

        ul:not(.sidebar) {
            list-style-type: disc;
        }

        ol:not(.sidebar)li {
            /* list-style-type: decimal; */
            margin-bottom: 10px;
        }


        /* Responsive */
        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-260px);
                width: 220px;
                transition: transform 0.3s ease;
            }

            .sidebar.active {
                transform: translateX(0);
            }

            main {
                margin-left: 0;
                width: 100%;
                padding: 25px 20px;
            }

            .notes {
                grid-template-columns: 1fr;
            }

            .note-l1 h2 {
                position: static;
                border-radius: 5px;
            }
        }

        /* Mobile Menu Toggle Button */
        .menu-toggle {
            display: none;
            position: fixed;
            top: 18px;
            left: 18px;
            background-color: #2e7d32;
            color: #fff;
            border: none;
            padding: 11px 16px;
            border-radius: 6px;
            cursor: pointer;
            z-index: 1000;
            font-size: 1.1rem;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.3);
            user-select: none;
        }

        @media (max-width: 768px) {
            .menu-toggle {
                display: block;
            }
        }
    </style>
</head>

<body>
    <!-- Sidebar & Menu Toggle -->
    <button class="menu-toggle" aria-label="Toggle menu">☰ Menu</button>
    <nav class="sidebar" aria-label="Sidebar Navigation">
        <ul>
            <li><a href="#section1">MongoDB</a></li>
            <li><a href="#section2">Document & Collections</a></li>
            <li><a href="#section3">Insert</a></li>
            <li><a href="#section4">View Data</a></li>
            <li><a href="#section5">Query Operators</a></li>
            <li><a href="#section6">Update</a></li>
            <li><a href="#section7">Delete</a></li>
            <hr>
            <li><a href="#section8">Mongoose</a></li>
            <li><a href="#section9">Schema</a></li>
            <li><a href="#section10">Models</a></li>
            <li><a href="#section11">Insert using Mongoose</a></li>
            <li><a href="#section12">Find using Mongoose</a></li>
            <li><a href="#section13">Update using Mongoose</a></li>
            <li><a href="#section14">Delete using Mongoose</a></li>
            <li><a href="#section15">Schema Validations</a></li>
            <li><a href="#section16">Database Relationships</a></li>
            <li><a href="#section17">Deletion in Relationships</a></li>
        </ul>
    </nav>


    <div class="navbar">
        <a href="https://indersauwalia.github.io/web-dev-notes/javascript.html" class="navelement js"
            style="color: #f7df1e;">
            Javascript <i class="fa-brands fa-js"></i>
        </a>
        <a href="https://indersauwalia.github.io/web-dev-notes/node-express.html" class="navelement nodex"
            style="color: #339933;">
            Node.js, Express.js <i class="fa-brands fa-node-js"></i>
        </a>
        <a href="https://indersauwalia.github.io/web-dev-notes/mongodb.html" class="navelement mongo"
            style="color: #47a248;">
            MongoDB <i class="fa-brands fa-envira"></i>
        </a>
        <a href="https://indersauwalia.github.io/web-dev-notes/reactNotes.html" class="navelement react"
            style="color: #61dafb;">
            React <i class="fa-brands fa-react"></i>
        </a>
        <a href="https://indersauwalia.github.io/web-dev-notes/cssnotes.html" class="navelement css" style="color: #264de4;">
            CSS <i class="fa-brands fa-css3-alt"></i>
        </a>
    </div>


    <main>
        <!-- MongoDB -->
        <section id="section1" class="note-section" tabindex="0">
            <div class="note-l1">
                <h2>MongoDB</h2>
                <p>
                    MongoDB is a NoSQL database that stores data in JSON-like documents (called BSON - Binary JSON). Unlike traditional SQL databases, MongoDB does not use tables and rows; instead, it uses collections and documents.
                </p>
                <div class="note-l2">
                    <h3>Key Features:</h3>
                    <ol>
                        <ul>
                            <li><span class="bolder">Schema-less</span>: You can store different fields in each document.</li>
                            <li><span class="bolder">Scalable</span>: Designed for horizontal scalability via sharding.</li>
                            <li><span class="bolder">High Performance</span>: Fast reads/writes with indexes and memory usage.</li>
                            <li><span class="bolder">Aggregation Framework</span>: Similar to SQL GROUP BY.</li>
                            <li><span class="bolder">Replication</span>: Data redundancy using replica sets.</li>
                            <li><span class="bolder">Ad-hoc Queries</span>: Rich query language with support for filtering and projections.</li>
                        </ul>                          
                    </ol>
                </div>
                <div class="note-l3">
                    <h4>BSON</h4>
                    <p>
                        BSON (Binary JSON) is a binary-encoded serialization format used by MongoDB to store and exchange data. It extends JSON to provide additional data types and efficient storage, making it ideal for MongoDB's document-oriented database.
                    </p> <br>
                    <p>
                        we provide data to MongoDB in JSON-like syntax (actually JavaScript objects in the shell or JSON in drivers), but… MongoDB automatically converts that data into BSON internally when storing it.
                    </p>
                </div>
                <div class="note-l2">
                    <h3>mongosh (Mongo Shell):</h3>
                    <p>
                        mongosh (MongoDB Shell) is a modern command-line tool for interacting with MongoDB databases.
                    </p>
                    <p>
                        Modern JavaScript Support: Built on Node.js, supports ES6+ features (e.g., async/await, arrow functions). Interactive REPL: Provides a JavaScript-based environment for querying and managing MongoDB databases.
                    </p>
                    <div class="note-l3">
                        <p>
                            To start mongosh use: mongosh
                        </p>
                        <div class="code-container">
                            <code>
                                Then use commands example:

                                show dbs // Show all databases
                                use mydb // Create/switch to database
                                show collections // List collections
                                e.t.c.
                            </code>
                        </div>
                    </div>
                </div>
            </div>
        </section>


        <!-- Document & Collections -->
        <section id="section2" class="note-section" tabindex="0">
            <div class="note-l1">
                <h2>Document & Collections</h2>
                <p>
                    In MongoDB, documents and collections are core components of its data model, used to store and organize data in a NoSQL, document-oriented database.
                </p>
                <div class="note-l2">
                    <h3>Document</h3>
                    <p>
                        A document is the basic unit of data in MongoDB. It's similar to a row in a SQL table. Stored in BSON Format. Contains key-value pairs. Each document has a unique _id field (like a primary key).
                    </p>
                    <p>
                        <span class="bolder">Structure:</span> Documents are composed of fields (keys) and values, where values can be strings, numbers, arrays, nested documents, or special types like ObjectId, Date, or Binary.
                    </p>
                    <p>
                        <span class="bolder">Flexibility:</span> Each document in a collection can have a different structure (no fixed schema).
                    </p>
                    <div class="code-container">
                        <code>
                            Example:

                            {
                                &nbsp;&nbsp;"_id": ObjectId("507f1f77bcf86cd799439011"),
                                &nbsp;&nbsp;"name": "Alice",
                                &nbsp;&nbsp;"age": 25,
                                &nbsp;&nbsp;"address": {
                                    &nbsp;&nbsp;&nbsp;&nbsp;"city": "New York",
                                    &nbsp;&nbsp;&nbsp;&nbsp;"country": "USA"
                                &nbsp;&nbsp;},
                                &nbsp;&nbsp;"hobbies": ["reading", "gaming"],
                                &nbsp;&nbsp;"createdAt": ISODate("2025-06-24T15:23:00Z")
                            }

                            _id: A unique identifier (auto-generated if not provided)
                        </code>
                    </div>
                </div>
                <div class="note-l2">
                    <h3>Collection</h3>
                    <p>
                        A collection is a group of documents. Similar to a table in SQL. You don't need to define a fixed schema. Each document inside a collection can have a different structure. Created automatically when you insert your first document.
                    </p>
                    <p>
                        <span class="bolder">Naming:</span> Collections are identified by a name (e.g., users, products). Names are case-sensitive and should avoid special characters.
                    </p>
                    <div class="code-container">
                        <code>
                            Example - A collection named users may contain:

                            // Document 1
                            { name: "Inderjit", age: 20 }
                            
                            // Document 2
                            { name: "Doe", email: "doe@gmail.com", hobbies: ["music", "yoga"] }
                            
                            // Document 3
                            { name: "John", isActive: false, city: "Delhi" }
                        </code>
                    </div>
                </div>
            </div>
        </section>


        <!-- Insert -->
        <section id="section3" class="note-section" tabindex="0">
            <div class="note-l1">
                <h2>Insert in MongoDB</h2>
                <p>
                    To insert data into a MongoDB database using mongosh, you can use methods like insertOne() for a single document or insertMany() for multiple documents.
                </p>
                <p>
                    Steps to Insert Data - 1. Connect to MongoDB, 2. Select a Database, 3. Insert into a Collection.
                </p>
                <div class="note-l2">
                    <h3>insertOne</h3>
                    <p>
                        The insertOne() method in MongoDB is used to insert a single document into a collection.
                    </p>
                    <div class="note-l3">
                        <h4>Syntax:</h4>
                        <p>
                            <span class="bolder">db.collection_name.insertOne({ document })</span>
                        </p>
                        <p>
                            collection_name: Name of the collection (automatically created if not present).
                        </p>
                        <p>
                            document: A single JavaScript object or JSON-like document.
                        </p>
                    </div>
                    <div class="code-container">
                        <code>
                            Example:
                            db.students.insertOne({
                                &nbsp;&nbsp;name: "Inderjit",
                                &nbsp;&nbsp;age: 20,
                                &nbsp;&nbsp;course: "CSE"
                            });

                            //This will create a document like:
                            {
                                &nbsp;&nbsp;_id: ObjectId("66a93d...."),
                                &nbsp;&nbsp;name: "Inderjit",
                                &nbsp;&nbsp;age: 20,
                                &nbsp;&nbsp;course: "CSE"
                            }

                            _id: A unique identifier (auto-generated if not provided)
                            //we can also use our custom id while inserting like _id: "stu001"

                            //collection(named students here) is automatically created if not there
                        </code>
                    </div>
                </div>
                <div class="note-l2">
                    <h3>insertMany</h3>
                    <p>
                        insertMany() is used to insert multiple documents into a MongoDB collection at once.
                    </p>
                    <div class="note-l3">
                        <h4>Syntax:</h4>
                        <p>
                            <span class="bolder">db.collection_name.insertMany([ { doc1 }, { doc2 }, ... ])</span>
                        </p>
                    </div>
                    <div class="code-container">
                        <code>
                            Example:
                            db.students.insertMany([
                                &nbsp;&nbsp;{ name: "Inderjit", age: 20, city: "Ludhiana" },
                                &nbsp;&nbsp;{ name: "john", age: 22, city: "Delhi" },
                                &nbsp;&nbsp;{ name: "Smith", age: 24, city: "Amritsar" }
                            ]);
                        </code>
                    </div>
                </div>
                <p>
                    There are other methods also to insert...
                </p>
            </div>
        </section>


        <!-- View Data -->
        <section id="section4" class="note-section" tabindex="0">
            <div class="note-l1">
                <h2>Insert in MongoDB</h2>
                <p>
                    MongoDB provides a method called find() to query and view documents inside a collection.
                </p>
                <div class="note-l2">
                    <h3>find()</h3>
                    <div class="note-l3">
                        <h4>Syntax:</h4>
                        <p>
                            <span class="bolder">db.collection.find()</span>
                        </p>
                        <p>
                            This displays all documents in the specified collection.
                        </p>
                    </div>
                    <div class="code-container">
                        <code>
                            Example:
                            db.students.find()

                            Output like:
                            { _id: ObjectId("66a950..."), name: "Inderjit", age: 20 }
                            { _id: ObjectId("66a951..."), name: "John", age: 22 }
                        </code>
                    </div>
                </div>
                <div class="note-l2">
                    <h3>find({ key: value })</h3>
                    <p>
                        Returns all documents that match the given key-value condition.
                    </p>
                    <p>
                        It returns a cursor object — not the actual documents directly. You can iterate over the cursor to access documents.
                    </p>
                    <div class="note-l3">
                        <h4>Syntax:</h4>
                        <p>
                            <span class="bolder">db.collection.find({ key: value })</span>
                        </p>
                    </div>
                    <div class="code-container">
                        <code>
                            Example:
                            db.students.find({ age: 20 })
                            //Returns all students with age = 20


                            //OR multiple conditions:
                            db.students.find({ age: 20, city: "jalandhar" })
                            //Returns all students with age = 20 AND city = jalandhar
                        </code>
                    </div>
                </div>
                <div class="note-l2">
                    <h3>find({ key: value })</h3>
                    <p>
                        Returns only the first document that matches the condition.
                    </p>
                    <p>
                        It returns a single document object. If no match is found, it returns null.
                    </p>
                    <div class="note-l3">
                        <h4>Syntax:</h4>
                        <p>
                            <span class="bolder">db.collection.findOne({ key: value })</span>
                        </p>
                    </div>
                    <div class="code-container">
                        <code>
                            Example:
                            db.students.findOne({ age: 20 })
                            //Returns only the first match with age = 20


                            //OR multiple conditions:
                            db.students.find({ age: 20, city: "jalandhar" })
                            //Returns all students with age = 20 AND city = jalandhar
                        </code>
                    </div>
                </div>
                <div class="note-l2">
                    <h3>find().pretty()</h3>
                    <p>
                        This formats the output to make it more readable.
                    </p>
                    <div class="note-l3">
                        <h4>Syntax:</h4>
                        <p>
                            <span class="bolder">db.collection.find().pretty()</span>
                        </p>
                    </div>
                    <div class="code-container">
                        <code>
                            Example:
                            db.students.find().pretty()

                            Output like:
                            {
                                &nbsp;&nbsp;"_id" : ObjectId("66a950..."),
                                &nbsp;&nbsp;"name" : "Inderjit",
                                &nbsp;&nbsp;"age" : 20
                            }
                            {
                                &nbsp;&nbsp;"_id" : ObjectId("66a951..."),
                                &nbsp;&nbsp;"name" : "John",
                                &nbsp;&nbsp;"age" : 22
                            }
                        </code>
                    </div>
                </div>
                <p>
                    There are other methods also...
                </p>
            </div>
        </section>


        <!-- Query Operators -->
        <section id="section5" class="note-section" tabindex="0">
            <div class="note-l1">
                <h2>Query Operators</h2>
                <p>
                    Query operators in MongoDB allow you to filter data using conditions like greater than, less than, not equal, matching arrays, etc. Used inside find() or findOne() to make powerful queries.
                </p>
                <div class="note-l2">
                    <h3>1. Comparison Operators</h3>
                    <p>
                        Match values based on comparisons.
                    </p>
                    <div class="note-l3">
                        <h4>$eq</h4>
                        <p>
                            Matches values equal to the specified value.
                        </p>
                        <div class="code-container">
                            <code>
                                Example:
                                db.users.find({ age: { $eq: 25 } })
                                //Output: Documents where age is exactly 25
                            </code>
                        </div>
                    </div>
                    <div class="note-l3">
                        <h4>$ne</h4>
                        <p>
                            Matches values not equal to the specified value.
                        </p>
                        <div class="code-container">
                            <code>
                                Example:
                                db.users.find({ status: { $ne: "active" } })
                                //Output: Documents where status is not "active"
                            </code>
                        </div>
                    </div>
                    <div class="note-l3">
                        <h4>$gt, $gte</h4>
                        <p>
                            $gt - Greater than, $gte - greater than or equa
                        </p>
                        <div class="code-container">
                            <code>
                                Example:
                                db.users.find({ age: { $gt: 25 } })
                                //Output: Documents where age &gt; 25
                            </code>
                        </div>
                    </div>
                    <div class="note-l3">
                        <h4>$lt, $lte</h4>
                        <p>
                            $lt - Less than, $lte - less than or equal.
                        </p>
                        <div class="code-container">
                            <code>
                                Example:
                                db.users.find({ age: { $lte: 28 } })
                                //Output: Documents where age &lt;= 28
                            </code>
                        </div>
                    </div>
                    <div class="note-l3">
                        <h4>$in</h4>
                        <p>
                            Matches any value in an array.
                        </p>
                        <div class="code-container">
                            <code>
                                Example:
                                db.users.find({ name: { $in: ["Alice", "Bob"] } })
                                //Output: Documents where name is "Alice" or "Bob"
                            </code>
                        </div>
                    </div>
                    <div class="note-l3">
                        <h4>$nin</h4>
                        <p>
                            Matches any value in an array.
                        </p>
                        <div class="code-container">
                            <code>
                                Example:
                                db.users.find({ name: { $nin: ["Alice", "Bob"] } })
                                //Output: Documents where name is neither "Alice" nor "Bob"
                            </code>
                        </div>
                    </div>
                </div>
                <div class="note-l2">
                    <h3>2. Logical Operators</h3>
                    <p>
                      Combine multiple conditions using logical expressions like AND, OR, NOT, NOR.
                    </p>
                  
                    <div class="note-l3">
                        <h4>$and</h4>
                        <p>
                            Returns documents that match all specified conditions.
                        </p>
                        <div class="code-container">
                            <code>
                                Example:
                                db.users.find({ $and: [ { age: { $gt: 20 } }, { status: "active" } ] })
                                //Output: Documents where age &gt; 20 AND status is "active"
                            </code>
                        </div>
                    </div>
                  
                    <div class="note-l3">
                        <h4>$or</h4>
                        <p>
                            Returns documents that match at least one of the conditions.
                        </p>
                        <div class="code-container">
                            <code>
                                Example:
                                db.users.find({ $or: [ { age: 25 }, { status: "inactive" } ] })
                                //Output: Documents where age is 25 OR status is "inactive"
                            </code>
                        </div>
                    </div>
                  
                    <div class="note-l3">
                        <h4>$not</h4>
                        <p>
                            Returns documents that do not match the condition.
                        </p>
                        <div class="code-container">
                            <code>
                                Example:
                                db.users.find({ age: { $not: { $gt: 30 } } })
                                //Output: Documents where age is NOT greater than 30
                            </code>
                        </div>
                    </div>
                  
                    <div class="note-l3">
                        <h4>$nor</h4>
                        <p>
                            Returns documents that match none of the specified conditions.
                        </p>
                        <div class="code-container">
                            <code>
                                Example:
                                db.users.find({ $nor: [ { age: 25 }, { status: "active" } ] })
                                //Output: Documents where age is NOT 25 AND status is NOT "active"
                            </code>
                        </div>
                    </div>
                </div>  
                <p>
                    There are other types of operators also like Element, Array, Evaluation, Geospatial, Bitwise Operators...
                </p>                
            </div>
        </section>


        <!-- Update -->
        <section id="section6" class="note-section" tabindex="0">
            <div class="note-l1">
                <h2>Update in DB</h2>
                <p>
                    In MongoDB, you can update documents in a database using methods like updateOne(), updateMany(), or replaceOne().
                </p>
                <div class="note-l2">
                    <h3>updateOne()</h3>
                    <p>
                        Updates only the first document that matches the filter condition.
                    </p>
                    <div class="note-l3">
                        <h4>Syntax:</h4>
                        <p>
                            <span class="bolder">db.collection.updateOne( { filter }, { update }, { options } )</span>
                        </p>
                        <p>
                            <ul>
                                <li>filter - The condition to find the document</li>
                                <li>update - The update operation</li>
                                <li>options(Optional) - Can include { upsert: true } to insert if not found</li>
                            </ul>
                        </p>
                    </div>
                    <div class="code-container">
                        <code>
                            Example:
                            db.users.updateOne( { name: "Inderjit" }, { $set: { age: 21 } } )
                            //Only the first user document with name "Inderjit" will have their age updated to 21
                        </code>
                    </div>
                </div>
                <div class="note-l2">
                    <h3>updateMany()</h3>
                    <p>
                        Updates all documents that match the filter condition.
                    </p>
                    <p>
                        Same syntax as above.
                    </p>
                    <div class="code-container">
                        <code>
                            Example:
                            db.users.updateMany( { status: "inactive" }, { $set: { status: "active" } } )
                            //Every document with status: "inactive" will be updated to "active"
                        </code>
                    </div>
                </div>
                <div class="note-l2">
                    <h3>replaceOne()</h3>
                    <p>
                        Replaces the entire first matching document (except _id) with a new one.
                    </p>
                    <div class="note-l3">
                        <h4>Syntax:</h4>
                        <p>
                            <span class="bolder">db.collection.replaceOne( { filter }, { replacement_document } )</span>
                        </p>
                        <p>
                            replacement_document - You must provide the full new document (excluding _id) — anything not included will be deleted from that document.
                        </p>
                    </div>
                    <div class="code-container">
                        <code>
                            Example:
                            db.users.replaceOne(
                                &nbsp;&nbsp;{ name: "Inderjit" },
                                &nbsp;&nbsp;{ name: "Inderjit", age: 21, city: "Amritsar" }
                            )

                            //Replaces the matched document completely. Any fields not in the replacement will be deleted (except _id, it will remain same).
                        </code>
                    </div>
                </div>
                <div class="note-l2">
                    <h3>Update and Aggregation Opertators</h3>
                    <div class="note-l3">
                        <h4>$set</h4>
                        <p>
                            Add a new field or update an existing field.
                        </p>
                        <div class="code-container">
                            <code>
                                Example:
                                db.users.updateOne( { name: "Inderjit" }, { $set: { age: 20 } } )
    
                                // Adds or updates the "age" field to 20
                            </code>
                        </div>
                    </div>
                    <div class="note-l3">
                        <h4>$unset</h4>
                        <p>
                            Remove a field from the document.
                        </p>
                        <div class="code-container">
                            <code>
                                Example:
                                db.users.updateOne( { name: "Inderjit" }, { $unset: { phone: "" } } )
    
                                //Removes the "phone" field from the document
                            </code>
                        </div>
                    </div>
                    <div class="note-l3">
                        <h4>$inc</h4>
                        <p>
                            Increment (or decrement) a numeric field.
                        </p>
                        <div class="code-container">
                            <code>
                                Example:
                                db.users.updateOne( { name: "Inderjit" }, { $inc: { views: 1 } } )
    
                                //Increases the "views" field by 1
                            </code>
                        </div>
                    </div>
                    <div class="note-l3">
                        <h4>$addFields (Aggregation)</h4>
                        <p>
                            Add new fields in aggregation pipeline.
                        </p>
                        <div class="code-container">
                            <code>
                                Example:
                                db.users.aggregate([ { $addFields: { isAdult: { $gte: ["$age", 18] } } } ])

                                // Adds "isAdult": true/false based on age
                            </code>
                        </div>
                    </div>
                    <div class="note-l3">
                        <h4>$project (Aggregation)</h4>
                        <p>
                            Include/exclude fields in aggregation output.
                        </p>
                        <div class="code-container">
                            <code>
                                Example:
                                db.users.aggregate([ { $project: { name: 1, age: 1, _id: 0 } } ])
                                // Shows only "name" and "age", hides "_id"
                            </code>
                        </div>
                    </div>
                    <div class="note-l3">
                        <h4>$replaceRoot (Aggregation)</h4>
                        <p>
                            Replace the current document with a subdocument.
                        </p>
                        <div class="code-container">
                            <code>
                                Example:
                                db.users.aggregate([ { $replaceRoot: { newRoot: "$profile" } } ])
                                // Replaces each document with the "profile" subdocument
                            </code>
                        </div>
                    </div>
                    <div class="note-l3">
                        <h4>$replaceWith (Aggregation)</h4>
                        <p>
                            Same as $replaceRoot, but more flexible.
                        </p>
                        <div class="code-container">
                            <code>
                                Example:
                                db.users.aggregate([ { $replaceWith: "$profile" } ])
                                // Same effect as $replaceRoot: replaces doc with "profile"
                            </code>
                        </div>
                    </div>
                    <div class="note-l3">
                        <h4>Syntax:</h4>
                        <p>
                            replacement_document - You must provide the full new document (excluding _id) — anything not included will be deleted from that document.
                        </p>
                        <div class="code-container">
                            <code>
                                Example:
                                db.users.replaceOne(
                                    &nbsp;&nbsp;{ name: "Inderjit" },
                                    &nbsp;&nbsp;{ name: "Inderjit", age: 21, city: "Amritsar" }
                                )
    
                                //Replaces the matched document completely. Any fields not in the replacement will be deleted (except _id, it will remain same).
                            </code>
                        </div>
                    </div>
                </div>

                <p>
                    There are other methods to update in DB...
                </p>                
            </div>
        </section>


        <!-- Delete -->
        <section id="section7" class="note-section" tabindex="0">
            <div class="note-l1">
                <h2>Delete in DB</h2>
                <p>
                    In MongoDB, you can delete documents from a database using methods like deleteOne() and deleteMany().
                </p>
                <div class="note-l2">
                    <h3>deleteOne()</h3>
                    <p>
                        Deletes only the first document that matches the filter.
                    </p>
                    <div class="note-l3">
                        <h4>Syntax:</h4>
                        <p>
                            <span class="bolder">db.collection.deleteOne(filter, options)</span>
                        </p>
                        <p>
                            <ul>
                                <li>filter - The condition to find the document</li>
                                <li>options - Optional settings, such as: writeConcern</li>
                            </ul>
                        </p>
                    </div>
                    <div class="code-container">
                        <code>
                            Example:
                            db.users.deleteOne({ name: "Inderjit" })
                            //Deletes the first document with name: "Inderjit"
                        </code>
                    </div>
                </div>
                <div class="note-l2">
                    <h3>deleteMany()</h3>
                    <p>
                        Deletes all documents that match the given filter condition.
                    </p>
                    <p>
                        Same syntax as above.
                    </p>
                    <div class="code-container">
                        <code>
                            Example:
                            db.users.deleteMany({ status: "inactive" })
                            //Deletes all users with status: "inactive".

                            <hr>
                            deleteMany({}) — Delete All Docs (Not Collection)
                            Example:
                            db.users.deleteMany({})
                            //Deletes all data from users, but keeps the collection.
                        </code>
                    </div>
                </div>
                <div class="note-l2">
                    <h3>drop() — Drop Entire Collection</h3>
                    <p>
                        Deletes the entire collection and its documents.
                    </p>
                    <div class="note-l3">
                        <h4>Syntax:</h4>
                        <p>
                            <span class="bolder">db.collection_name.drop()</span>
                        </p>
                    </div>
                    <div class="code-container">
                        <code>
                            Example:
                            db.users.drop()
                            //Deletes users collection permanently.
                        </code>
                    </div>
                </div>
                <div class="note-l2">
                    <h3>dropDatabase() — Drop Entire Database</h3>
                    <p>
                        Deletes the entire current database, including all collections.
                    </p>
                    <div class="note-l3">
                        <h4>Syntax:</h4>
                        <p>
                            <span class="bolder">db.dropDatabase()</span>
                        </p>
                    </div>
                    <div class="code-container">
                        <code>
                            Example:
                            //first select that database which you want to delete
                            use shopDB

                            db.dropDatabase()
                            //Deletes shopDB with all its collections.
                        </code>
                    </div>
                </div>

            </div>
        </section>


        <!-- Mongoose -->
        <section id="section8" class="note-section" tabindex="0">
            <div class="note-l1">
                <h2>Mongoose</h2>
                <p>
                    Mongoose is an Object Data Modeling (ODM) library for MongoDB and Node.js. It provides a schema-based solution to model your application data and includes built-in type casting, validation, query building, and business logic hooks.
                </p>
                <div class="note-l2">
                    <h3>Key Features of Mongoose:</h3>
                    <ul>
                        <li>Schema Definition: Define structured schemas for your MongoDB collections.</li>
                        <li>Validation: Built-in validation for data integrity.</li>
                        <li>Middleware: Hooks for pre- and post-save operations.</li>
                        <li>Query Building: Simplifies MongoDB queries with a fluent API.</li>
                        <li>Population: Easily reference related documents (like JOINs in SQL).</li>
                    </ul>
                </div>
                <div class="note-l2">
                    <h3>Setup:</h3>
                    <div class="code-container">
                        <code>
                            Install Mongoose - npm install mongoose

                            <hr>
                            Connect to MongoDB using Mongoose:
                            const mongoose = require('mongoose'); //require it


                            // Use the async function to connect and handle errors
                            main()
                                &nbsp;&nbsp;.catch((err) => {
                                &nbsp;&nbsp;console.log("Connection error:", err);
                            });
                            
                            async function main() {
                                &nbsp;&nbsp;// Try to connect
                                &nbsp;&nbsp;await mongoose.connect("mongodb://127.0.0.1:27017/test");
                            }
                        </code>
                    </div>
                    <ul>
                        <li><span class="bolder">mongoose.connect(...)</span> - This function connects your Node.js app to a MongoDB database using Mongoose.</li>
                        <li><span class="bolder">mongodb:// (Protocol)</span> -&gt; tells Mongoose to use the MongoDB connection</li>
                        <li><span class="bolder">127.0.0.1 (Host)</span> —&gt; this is the localhost IP address (means MongoDB is running on your own computer)</li>
                        <li><span class="bolder">27017 (Port)</span> -&gt; this is the default port MongoDB runs on</li>
                        <li><span class="bolder">/test (Database name)</span>  —&gt; this tells Mongoose to connect to the test database (it will be created if it doesn't exist)</li>
                    </ul>
                </div>
            </div>
        </section>


        <!-- Schema -->
        <section id="section9" class="note-section" tabindex="0">
            <div class="note-l1">
                <h2>Schema</h2>
                <p>
                    In Mongoose, a schema defines the structure of documents within a MongoDB collection (like blueprint for each document). It specifies fields, their data types, validation rules, and other constraints. Schemas are used to create models, which allow you to interact with the database.
                </p>
                <div class="code-container">
                    <code>
                        // Exampls - Define a schema
                        const userSchema = new mongoose.Schema({
                            &nbsp;&nbsp;name: { type: String, required: true },
                            &nbsp;&nbsp;age: Number,
                            &nbsp;&nbsp;email: { type: String, unique: true },
                            &nbsp;&nbsp;createdAt: { type: Date, default: Date.now }
                        });
                        //also String is shorthand of {type: String}

                        <hr>
                        Example - Nested Schemas:
                        const addressSchema = new mongoose.Schema({
                            &nbsp;&nbsp;street: String,
                            &nbsp;&nbsp;city: String
                        });
                        const userSchema = new mongoose.Schema({
                            &nbsp;&nbsp;name: String,
                            &nbsp;&nbsp;address: addressSchema
                        });
                    </code>
                </div>
                <div class="note-l3">
                    <h4>Common Mongoose Schema Types</h4>
                    <table>
                        <thead>
                            <tr>
                                <th>Data Type</th>
                                <th>Description</th>
                                <th>Example</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>String</code></td>
                                <td>Text/string data</td>
                                <td><code>name: String</code></td>
                            </tr>
                            <tr>
                                <td><code>Number</code></td>
                                <td>Integer or float</td>
                                <td><code>age: Number</code></td>
                            </tr>
                            <tr>
                                <td><code>Boolean</code></td>
                                <td><code>true</code> or <code>false</code></td>
                                <td><code>isActive: Boolean</code></td>
                            </tr>
                            <tr>
                                <td><code>Date</code></td>
                                <td>Stores date and time</td>
                                <td><code>createdAt: Date</code></td>
                            </tr>
                            <tr>
                                <td><code>Buffer</code></td>
                                <td>Binary data (e.g., images/files)</td>
                                <td><code>avatar: Buffer</code></td>
                            </tr>
                            <tr>
                                <td><code>ObjectId</code></td>
                                <td>References another document</td>
                                <td><code>userId: mongoose.Schema.Types.ObjectId</code></td>
                            </tr>
                            <tr>
                                <td><code>Array</code></td>
                                <td>List of any type</td>
                                <td><code>tags: [String]</code></td>
                            </tr>
                            <tr>
                                <td><code>Mixed</code></td>
                                <td>Any type (not strict)</td>
                                <td><code>anyField: mongoose.Schema.Types.Mixed</code></td>
                            </tr>
                            <tr>
                                <td><code>Map</code></td>
                                <td>Key-value pairs with same type values</td>
                                <td><code>meta: Map</code></td>
                            </tr>
                            <tr>
                                <td><code>Decimal128</code></td>
                                <td>High-precision decimal (money, etc.)</td>
                                <td><code>price: mongoose.Schema.Types.Decimal128</code></td>
                            </tr>
                        </tbody>
                    </table>                      
                    <div class="code-container">
                        <code>
                            Example Schema Using most Types:
                            const userSchema = new mongoose.Schema({
                                &nbsp;&nbsp;name: String,
                                &nbsp;&nbsp;age: Number,
                                &nbsp;&nbsp;email: { type: String, required: true },
                                &nbsp;&nbsp;isActive: Boolean,
                                &nbsp;&nbsp;createdAt: { type: Date, default: Date.now },
                                &nbsp;&nbsp;profilePic: Buffer,
                                &nbsp;&nbsp;role: { type: mongoose.Schema.Types.ObjectId, ref: 'Role' }, // foreign key
                                &nbsp;&nbsp;tags: [String],
                                &nbsp;&nbsp;extraInfo: mongoose.Schema.Types.Mixed,
                                &nbsp;&nbsp;stats: { type: Map, of: Number },
                                &nbsp;&nbsp;salary: mongoose.Schema.Types.Decimal128
                            });
                        </code>
                    </div>
                </div>
            </div>
        </section>


        <!-- Models -->
        <section id="section10" class="note-section" tabindex="0">
            <div class="note-l1">
                <h2>Models</h2>
                <p>
                    A Model in Mongoose is a constructor function created from a Schema. It represents a collection in your MongoDB database and provides an interface to interact with the documents (records) in that collection.
                </p>
                <div class="note-l3">
                    <h4>Syntax:</h4>
                    <p>
                        <span class="bolder">const ModelName = mongoose.model('CollectionName', schemaName);</span>
                    </p>
                    <p>
                        'CollectionName': Mongoose auto-pluralizes and makes it lowercase (e.g., 'User' → users collection).
                    </p>
                    <p>
                        Generelly we take same ModelName and CollectionName.
                    </p>
                </div>
                <div class="code-container">
                    <code>
                        // Example
                        const User = mongoose.model('User', userSchema);
                    </code>
                </div>
            </div>
        </section>

        <!-- Insert using Mongoose -->
        <section id="section11" class="note-section" tabindex="0">
            <div class="note-l1">
                <h2>Insert using Mongoose</h2>
                <p>
                    Mongoose provides several methods to insert documents into a MongoDB collection using a model. Below, are the primary methods for inserting data.
                </p>
                <p>
                    In Mongoose insert methods, an _id is automatically assigned to every document by default, unless you manually specify one.
                </p>
                <p>
                    First Connect to database and Define a schema and model then:
                </p>
                <div class="note-l2">
                    <h3>1. new and .save()</h3>
                    <p>
                        Create a new document instance and save it to the database.
                    </p>
                    <div class="code-container">
                        <code>
                            // Example
                            const newUser = new User({
                                &nbsp;&nbsp;name: 'Alice',
                                &nbsp;&nbsp;age: 25,
                                &nbsp;&nbsp;email: 'alice@example.com'
                            });
                            newUser.save() //it writes it to MongoDB
                                &nbsp;&nbsp;.then(user => console.log('User saved:', user))
                                &nbsp;&nbsp;.catch(err => console.error('Error:', err));

                            //.save() Returns a promise with the created document.
                            //When to use: Best for single document creation, Good for validation and middleware
                        </code>
                    </div>
                </div>
                <div class="note-l2">
                    <h3>2. Model.create()</h3>
                    <p>
                        Insert one or multiple documents directly.
                    </p>
                    <div class="code-container">
                        <code>
                            // Example - Insert Single document
                            User.create({
                                &nbsp;&nbsp;name: 'Bob',
                                &nbsp;&nbsp;age: 30,
                                &nbsp;&nbsp;email: 'bob@example.com'
                            })
                                &nbsp;&nbsp;.then(user => console.log('User created:', user))
                                &nbsp;&nbsp;.catch(err => console.error('Error:', err));

                            <hr>
                            // Insert Multiple documents
                            User.create([
                                &nbsp;&nbsp;{ name: 'Charlie', age: 28, email: 'charlie@example.com' },
                                &nbsp;&nbsp;{ name: 'Diana', age: 22, email: 'diana@example.com' }
                            ])
                                &nbsp;&nbsp;.then(users => console.log('Users created:', users))
                                &nbsp;&nbsp;.catch(err => console.error('Error:', err));

                            
                            //When to use: Convenient for quick inserts, especially for multiple documents.
                            //Note: Returns a promise with the created document(s) and triggers validation/middleware.
                        </code>
                    </div>
                </div>
                <div class="note-l2">
                    <h3>3. Model.insertMany()</h3>
                    <p>
                        Insert multiple documents efficiently in a single operation.
                    </p>
                    <div class="code-container">
                        <code>
                            // Example
                            User.insertMany([
                                &nbsp;&nbsp;{ name: 'Eve', age: 35, email: 'eve@example.com' },
                                &nbsp;&nbsp;{ name: 'Frank', age: 40, email: 'frank@example.com' }
                            ])
                                &nbsp;&nbsp;.then(users => console.log('Users inserted:', users))
                                &nbsp;&nbsp;.catch(err => console.error('Error:', err));

                            //also returns promise
                            //When to use: Optimized for bulk inserts, faster than multiple .create() calls.
                            //Note: By default, stops on the first error unless { ordered: false } is specified to continue inserting valid documents.
                        </code>
                    </div>
                </div>
                <p>There may other ways also to insert...</p>
                <div class="note-l2">
                    <h3>Operation Buffering in Mongoose</h3>
                    <p>
                        Mongoose buffers operations (like Model.create(), Model.find(), or document.save()) if the MongoDB connection isn't ready (e.g., the database is still connecting). Once the connection is established, Mongoose executes the buffered operations in the order they were queued.
                    </p>
                </div>
            </div>
        </section>


        <!-- Find using Mongoose -->
        <section id="section12" class="note-section" tabindex="0">
            <div class="note-l1">
                <h2>Find using Mongoose</h2>
                <p>
                    Mongoose provides several methods to query documents in a MongoDB collection using a model. These methods allow you to retrieve data based on criteria, sort results, limit fields, and more. Below, are the primary methods for finding data.
                </p>
                <p>
                    They return a Query object, not the actual user array. The actual data comes after the query executes (with .then() or await). <br>
                    Mongoose queries are "thenable" — meaning they behave like promises, even though they are not full Promise objects internally.
                </p>
                <div class="note-l2">
                    <h3>1. find()</h3>
                    <p>
                        Fetches all documents that match the given query criteria. Returns an array of matching documents (or an empty array if no matches are found).
                    </p>
                    <div class="note-l3">
                        <h4>Syntax:</h4>
                        <p>
                            <span class="bolder">Model.find(query, [projection], [options])</span>
                        </p>
                        <p>
                            <ul>
                                <li>Model: model name</li>
                                <li>query: An object specifying the search criteria (e.g., { age: { $gte: 18 } })</li>
                                <li>projection (optional): Specifies which fields to include/exclude (e.g., { name: 1, _id: 0 })</li>
                                <li>options (optional): Additional query options (e.g., { sort: { age: -1 }, limit: 10 })</li>
                            </ul>
                        </p>
                    </div>
                    <div class="code-container">
                        <code>
                            // Example - Find all users aged 18 or older
                            User.find({ age: { $gte: 18 } })
                                &nbsp;&nbsp;.then(users => console.log('Users:', users))
                                &nbsp;&nbsp;.catch(err => console.error('Error:', err));
                        </code>
                    </div>
                </div>
                <div class="note-l2">
                    <h3>2. Model.findOne()</h3>
                    <p>
                        Retrieves the first document that matches the provided query criteria. Returns a single document or null if no match is found.
                    </p>
                    <p>
                        Syntax - same as above
                    </p>
                    <div class="code-container">
                        <code>
                            // Example - Find the first user with a specific email
                            User.findOne({ email: "alice@example.com" })
                                &nbsp;&nbsp;.then(user => console.log('User:', user || 'Not found'))
                                &nbsp;&nbsp;.catch(err => console.error('Error:', err));
                        </code>
                    </div>
                </div>
                <div class="note-l2">
                    <h3>3. Model.findById()</h3>
                    <p>
                        Retrieves a single document by its _id field (MongoDB's unique ObjectID). Returns a single document or null if no match is found.
                    </p>
                    <p>
                        Syntax - same as above, just at place of query id of object
                    </p>
                    <div class="code-container">
                        <code>
                            // Find a user by their _id
                            User.findById("507f1f77bcf86cd799439011")
                                &nbsp;&nbsp;.then(user => console.log('User:', user || 'Not found'))
                                &nbsp;&nbsp;.catch(err => console.error('Error:', err));
                        </code>
                    </div>
                </div>
                <p>There may other ways also to find...</p>
            </div>
        </section>


        <!-- Update using Mongoose -->
        <section id="section13" class="note-section" tabindex="0">
            <div class="note-l1">
                <h2>Update using Mongoose</h2>
                <p>
                    You can update documents in MongoDB using Mongoose with several methods, primarily updateOne(), updateMany(), findByIdAndUpdate() and findOneAndUpdate() e.t.c.
                </p>
                <div class="note-l2">
                    <h3>1. updateOne()</h3>
                    <p>
                        Updates first matching document that matches your filter.
                    </p>
                    <p>
                        Does not return the updated document.
                    </p>
                    <div class="note-l3">
                        <h4>Syntax:</h4>
                        <p>
                            <span class="bolder">Model.updateOne(filter, update, options)</span>
                        </p>
                    </div>
                    <div class="code-container">
                        <code>
                            User.updateOne({ email: "test@example.com" }, { $set: { name: "Inderjit" } });
                        </code>
                    </div>
                </div>
                <div class="note-l2">
                    <h3>2. updateMany()</h3>
                    <p>
                        Updates all documents that matches filter condition. Syntax same as above.
                    </p>
                    <p>
                        Does not return the updated documents.
                    </p>
                    <div class="code-container">
                        <code>
                            User.updateMany({ role: "guest" }, { $set: { active: false } });
                        </code>
                    </div>
                </div>
                <div class="note-l2">
                    <h3>3. findOneAndUpdate()</h3>
                    <p>
                        This method finds the first matching document, updates it, and returns the document.
                    </p>
                    <p>
                        Syntax - same as above.
                    </p>
                    <div class="code-container">
                        <code>
                            User.findOneAndUpdate({ email: "a@b.com" }, { name: "Ajay" }, { new: true });
                            //setting new = true returns new updated document.
                        </code>
                    </div>
                </div>
                <div class="note-l2">
                    <h3>4. findByIdAndUpdate()</h3>
                    <p>
                        This is a convenient shorthand for findOneAndUpdate(). It works exactly the same way but uses the document's unique _id as the filter.
                    </p>
                    <p>
                        Syntax - same as above just id at place of query.
                    </p>
                    <p>
                        Return Value: Same as findOneAndUpdate(). It returns the document (original by default, updated if { new: true } is set) or null if the ID doesn't exist.
                    </p>
                    <div class="code-container">
                        <code>
                            User.findByIdAndUpdate("64d3...f6", { age: 22 }, { new: true });
                        </code>
                    </div>
                </div>
                <p>There may other ways also to update...</p>
            </div>
        </section>


        <!-- Delete using Mongoose -->
        <section id="section14" class="note-section" tabindex="0">
            <div class="note-l1">
                <h2>Delete using Mongoose</h2>
                <p>
                    Here are the different methods to delete documents in Mongoose, each with its specific use case:
                </p>
                <div class="note-l2">
                    <h3>1. deleteOne()</h3>
                    <p>
                        Deletes first matching document that matches your query.
                    </p>
                    <p>
                        Return Value: An object confirming the operation, like { acknowledged: true, deletedCount: 1 }. It does not return the deleted document.
                    </p>
                    <div class="note-l3">
                        <h4>Syntax:</h4>
                        <p>
                            <span class="bolder">Model.deleteOne(query)</span>
                        </p>
                    </div>
                    <div class="code-container">
                        <code>
                            User.deleteOne({ email: "test@example.com" })
                                &nbsp;&nbsp;.then(result =&gt; console.log(result))
                                &nbsp;&nbsp;.catch(err =&gt; console.error(err));
                        </code>
                    </div>
                </div>
                <div class="note-l2">
                    <h3>2. deleteMany()</h3>
                    <p>
                        Deletes all documents that match the query. Syntax - same as above.
                    </p>
                    <p>
                        Return Value: An object confirming the operation, like { acknowledged: true, deletedCount: 5 }, where deletedCount is the number of documents removed.
                    </p>
                    <div class="code-container">
                        <code>
                            User.deleteMany({ role: "guest" })
                                &nbsp;&nbsp;.then(result =&gt; console.log(result))
                                &nbsp;&nbsp;.catch(err =&gt; console.error(err));
                        </code>
                    </div>
                </div>
                <div class="note-l2">
                    <h3>3. findByIdAndDelete()</h3>
                    <p>
                        This is a convenient method to find a document by its unique _id and delete it.
                    </p>
                    <p>
                        Unlike the others, this method returns the document that was deleted or null if no document was found with that ID. Syntax - same as above just id at place of query.
                    </p>
                    <div class="code-container">
                        <code>
                            User.findByIdAndDelete("64e4...abc")
                                &nbsp;&nbsp;.then(deletedDoc => console.log(deletedDoc))
                                &nbsp;&nbsp;.catch(err => console.error(err));
                        </code>
                    </div>
                </div>
                <div class="note-l2">
                    <h3>4. findOneAndDelete()</h3>
                    <p>
                        Finds the first matching document and deletes it.
                    </p>
                    <p>
                        Return Value: The deleted document object, or null if no document matched the query condition.
                    </p>
                    <div class="note-l3">
                        <h4>Syntax:</h4>
                        <p>
                            <span class="bolder">Model.findOneAndDelete(filter, options)</span>
                            <p>
                                options (optional)
                            </p>
                        </p>
                    </div>
                    <div class="code-container">
                        <code>
                            User.findOneAndDelete({ email: "user@example.com" })
                                &nbsp;&nbsp;.then(deletedDoc => console.log(deletedDoc))
                                &nbsp;&nbsp;.catch(err => console.error(err));
                        </code>
                    </div>
                </div>
                <p>There may other ways also to delete...</p>
            </div>
        </section>


        <!-- Schema Validations -->
        <section id="section15" class="note-section" tabindex="0">
            <div class="note-l1">
                <h2>Schema Validations</h2>
                <p>
                    Mongoose schema validations are rules defined in the schema to ensure that documents meet specific criteria before being saved to the MongoDB database. If a document violates these rules, Mongoose throws a ValidationError and prevents the operation.
                </p>
                <div class="note-l2">
                    <h3>Some Validators/ Options</h3>
                    <table>
                        <thead>
                            <tr>
                                <th>Validator / Option</th>
                                <th>Description</th>
                                <th>Data Types</th>
                                <th>Example Usage</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>required</code></td>
                                <td>Field is mandatory</td>
                                <td>All</td>
                                <td><code>{ type: String, required: true }</code></td>
                            </tr>
                            <tr>
                                <td><code>default</code></td>
                                <td>Sets a default value if none is provided</td>
                                <td>All</td>
                                <td><code>{ type: Boolean, default: true }</code></td>
                            </tr>
                            <tr>
                                <td><code>unique</code></td>
                                <td>Creates a unique index in MongoDB (not a real validator)</td>
                                <td>All</td>
                                <td><code>{ type: String, unique: true }</code></td>
                            </tr>
                            <tr>
                                <td><code>minlength</code></td>
                                <td>Minimum string length</td>
                                <td>String</td>
                                <td><code>{ type: String, minlength: 5 }</code></td>
                            </tr>
                            <tr>
                                <td><code>maxlength</code></td>
                                <td>Maximum string length</td>
                                <td>String</td>
                                <td><code>{ type: String, maxlength: 50 }</code></td>
                            </tr>
                            <tr>
                                <td><code>min</code></td>
                                <td>Minimum numeric or date value</td>
                                <td>Number, Date</td>
                                <td><code>{ type: Number, min: 18 }</code> or <code>{ type: Date, min: '2022-01-01' }</code></td>
                            </tr>
                            <tr>
                                <td><code>max</code></td>
                                <td>Maximum numeric or date value</td>
                                <td>Number, Date</td>
                                <td><code>{ type: Number, max: 100 }</code></td>
                            </tr>
                            <tr>
                                <td><code>match</code></td>
                                <td>Value must match given regular expression</td>
                                <td>String</td>
                                <td><code>{ type: String, match: /.+\@.+\..+/ }</code></td>
                            </tr>
                            <tr>
                                <td><code>enum</code></td>
                                <td>Value must be one of a fixed set</td>
                                <td>String, Number</td>
                                <td><code>{ type: String, enum: ['admin', 'user', 'guest'] }</code></td>
                            </tr>
                            <tr>
                                <td><code>validate</code></td>
                                <td>Custom sync or async validator function</td>
                                <td>All</td>
                                <td>
                                    <code>
                                        { type: Number,
                                            validate: { validator: v => v % 2 === 0, message: props => `${props.value} is not even!`}
                                        }
                                    </code>
                                </td>
                            </tr>
                            <tr>
                                <td><code>immutable</code></td>
                                <td>Prevents changes once value is set</td>
                                <td>All</td>
                                <td><code>{ type: String, immutable: true }</code></td>
                            </tr>
                            <tr>
                                <td><code>alias</code></td>
                                <td>Creates a virtual alias for a field</td>
                                <td>All</td>
                                <td><code>{ type: String, alias: 'nickname' }</code></td>
                            </tr>
                            <tr>
                                <td><code>select</code></td>
                                <td>Whether the field is included by default in queries</td>
                                <td>All</td>
                                <td><code>{ type: String, select: false }</code></td>
                            </tr>
                            <tr>
                                <td><code>get / set</code></td>
                                <td>Transforms value on get/set</td>
                                <td>All</td>
                                <td><code>{ type: Number, get: v => Math.round(v) }</code></td>
                            </tr>
                            <tr>
                                <td><code>lowercase</code></td>
                                <td>Converts string to lowercase automatically</td>
                                <td>String</td>
                                <td><code>{ type: String, lowercase: true }</code></td>
                            </tr>
                            <tr>
                                <td><code>uppercase</code></td>
                                <td>Converts string to uppercase automatically</td>
                                <td>String</td>
                                <td><code>{ type: String, uppercase: true }</code></td>
                            </tr>
                            <tr>
                                <td><code>trim</code></td>
                                <td>Trims whitespace from both ends of a string</td>
                                <td>String</td>
                                <td><code>{ type: String, trim: true }</code></td>
                            </tr>
                            <tr>
                                <td colspan="4">There may be others also...</td>
                            </tr>
                        </tbody>
                    </table>
                    <div class="code-container">
                        <code>
                            const mongoose = require('mongoose');
                            
                            const userSchema = new mongoose.Schema({
                                &nbsp;&nbsp;name: {
                                    &nbsp;&nbsp;&nbsp;&nbsp;type: String,
                                    &nbsp;&nbsp;&nbsp;&nbsp;required: true, // must be present
                                    &nbsp;&nbsp;&nbsp;&nbsp;minlength: 3, // at least 3 characters
                                    &nbsp;&nbsp;&nbsp;&nbsp;maxlength: 50 // max 50 characters
                                &nbsp;&nbsp;},
                                &nbsp;&nbsp;email: {
                                    &nbsp;&nbsp;&nbsp;&nbsp;type: String,
                                    &nbsp;&nbsp;&nbsp;&nbsp;required: true,
                                    &nbsp;&nbsp;&nbsp;&nbsp;unique: true, // must be unique (index-level)
                                    &nbsp;&nbsp;&nbsp;&nbsp;match: /.+\@.+\..+/ // basic email format
                                &nbsp;&nbsp;},
                                &nbsp;&nbsp;password: {
                                    &nbsp;&nbsp;&nbsp;&nbsp;type: String,
                                    &nbsp;&nbsp;&nbsp;&nbsp;required: true,
                                    &nbsp;&nbsp;&nbsp;&nbsp;minlength: 6 // minimum 6 characters
                                &nbsp;&nbsp;},
                                &nbsp;&nbsp;age: {
                                    &nbsp;&nbsp;&nbsp;&nbsp;type: Number,
                                    &nbsp;&nbsp;&nbsp;&nbsp;min: 18, // must be at least 18
                                    &nbsp;&nbsp;&nbsp;&nbsp;max: 60 // no older than 60
                                &nbsp;&nbsp;},
                                &nbsp;&nbsp;role: {
                                    &nbsp;&nbsp;&nbsp;&nbsp;type: String,
                                    &nbsp;&nbsp;&nbsp;&nbsp;enum: ['admin', 'user', 'guest'], // only allowed values
                                    &nbsp;&nbsp;&nbsp;&nbsp;default: 'user'
                                &nbsp;&nbsp;},
                                &nbsp;&nbsp;isActive: {
                                    &nbsp;&nbsp;&nbsp;&nbsp;type: Boolean,
                                    &nbsp;&nbsp;&nbsp;&nbsp;default: true // true if not specified
                                &nbsp;&nbsp;},
                                &nbsp;&nbsp;createdAt: {
                                    &nbsp;&nbsp;&nbsp;&nbsp;type: Date,
                                    &nbsp;&nbsp;&nbsp;&nbsp;default: Date.now // current timestamp
                                &nbsp;&nbsp;},
                                &nbsp;&nbsp;phone: {
                                    &nbsp;&nbsp;&nbsp;&nbsp;type: String,
                                    &nbsp;&nbsp;&nbsp;&nbsp;validate: {
                                    &nbsp;&nbsp;&nbsp;&nbsp;validator: function (v) {
                                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return /^\d{10}$/.test(v); // must be a 10-digit number
                                    &nbsp;&nbsp;&nbsp;&nbsp;},
                                    &nbsp;&nbsp;&nbsp;&nbsp;message: props =&gt; `${props.value} is not a valid 10-digit phone number!`
                                &nbsp;&nbsp;},
                                    &nbsp;&nbsp;&nbsp;&nbsp;required: true
                                &nbsp;&nbsp;}
                            });
                            
                            const User = mongoose.model('User', userSchema);
                        </code>
                    </div>
                </div>
                <div class="note-l2">
                    <h3>Validators with Custom Error Messages</h3>
                    <div class="note-l3">
                        <h4>Syntax:</h4>
                        <p>
                            <span class="bolder">validatorName: [value, 'Custom error message']</span>
                            <p>
                                This format works for most built-in validators like min, max, minlength, maxlength, match, enum.
                            </p>
                        </p>
                    </div>
                    <div class="code-container">
                        <code>
                            example:
                            age: {
                                &nbsp;&nbsp;type: Number,
                                &nbsp;&nbsp;min: [18, 'Age must be at least 18']
                            }

                            role: {
                                &nbsp;&nbsp;type: String,
                                &nbsp;&nbsp;enum: {
                                    &nbsp;&nbsp;&nbsp;&nbsp;values: ['admin', 'user', 'guest'],
                                    &nbsp;&nbsp;&nbsp;&nbsp;message: 'Role must be admin, user, or guest'
                                &nbsp;&nbsp;}
                            }
                            //Use { values: [...], message: '...' } for enum.

                            <hr>
                            user.save()
                                &nbsp;&nbsp;.then(() => console.log('Saved!'))
                                &nbsp;&nbsp;.catch(err => {
                                    &nbsp;&nbsp;&nbsp;&nbsp;console.log(err.errors.age.message); // Access the custom error message something like this
                            });
                        </code>
                    </div>
                </div>
                <div class="note-l2">
                    <h3>Validation on Update Operations</h3>
                    <p>
                        By default, Mongoose does NOT run validators on update operations like: updateOne(), updateMany(), findByIdAndUpdate(), findOneAndUpdate() e.t.c.
                    </p>
                    <p>
                        To Enable Validation on Updates You must explicitly enable validation using the option - { runValidators: true }
                    </p>
                    <div class="code-container">
                        <code>
                            example:

                            const userSchema = new mongoose.Schema({
                                &nbsp;&nbsp;age: {
                                    &nbsp;&nbsp;&nbsp;&nbsp;type: Number,
                                    &nbsp;&nbsp;&nbsp;&nbsp;min: [18, 'Age must be at least 18']
                                &nbsp;&nbsp;}
                            });
                            
                            const User = mongoose.model('User', userSchema);
                            
                            //while updating
                            User.findByIdAndUpdate(
                                &nbsp;&nbsp;'64e4abc...', // some _id
                                &nbsp;&nbsp;{ age: 10 },
                                &nbsp;&nbsp;{ runValidators: true})

                                &nbsp;&nbsp;.then(user => console.log('Updated:', user))
                                &nbsp;&nbsp;.catch(err => console.log('Validation Error:', err.errors.age.message));

                            //Without runValidators: true, the invalid value will be silently accepted

                            //Always include runValidators: true in update operations if you want schema rules enforced.
                        </code>
                    </div>
                </div>
            </div>
        </section>


        <!-- Database Relationships -->
        <section id="section16" class="note-section" tabindex="0">
            <div class="note-l1">
                <h2>Database Relationships</h2>
                <p>
                    MongoDB does not enforce strict relationships like SQL databases, but you can model relationships between documents in various ways depending on your use case. MongoDB manages relationships between data using embedded documents (denormalization) or references (normalization).
                </p>
                <p>
                    Types of Relationships in MongoDB
                    <ul>
                        <li>One-to-One (1:1)</li>
                        <li>One-to-Many (1:N)</li>
                        <li>Many-to-Many (M:N)</li>
                    </ul>
                </p>
                <p>
                    Each can be implemented using: Embedding (Denormalization) OR Referencing (Normalization).
                </p>
                <div class="note-l3">
                    <h4>Embedding (Denormalization)</h4>
                    <p>
                        In embedding, related data is stored within the same document. This is called denormalization because it duplicates related data rather than storing it separately.
                    </p>
                    <div class="code-container">
                        <code>
                            Example: One-to-Many:
                            // Blog Post document with embedded comments
                            {
                                &nbsp;&nbsp;_id: ObjectId("postId1"),
                                &nbsp;&nbsp;title: "MongoDB Embedding",
                                &nbsp;&nbsp;content: "This is about embedding documents.",
                                &nbsp;&nbsp;comments: [
                                    &nbsp;&nbsp;&nbsp;&nbsp;{ user: "Alice",text: "Great article!", },
                                    &nbsp;&nbsp;&nbsp;&nbsp;{ user: "Bob",text: "Very helpful!", }
                                &nbsp;&nbsp;]
                            }
                        </code>
                    </div>
                    <p>
                        Use Cases: One-to-one or one-to-few relationships. When the embedded data is always read/updated with the parent. Example: product and product details, user and settings.
                    </p>
                    <p>
                        Disadvantages: Data duplication (if same subdocument is needed elsewhere). Document size limit (16MB) can be hit. Difficult to update individual embedded items.
                    </p>
                </div>
                <div class="note-l3">
                    <h4>Referencing (Normalization)</h4>
                    <p>
                        In referencing, related data is stored in separate collections and linked using ObjectId references. This follows normalization, like in relational databases.
                    </p>
                    <div class="code-container">
                        <code>
                            Example: One-to-Many:
                            // Post document
                            {
                                &nbsp;&nbsp;_id: ObjectId("postId1"),
                                &nbsp;&nbsp;title: "MongoDB Referencing",
                                &nbsp;&nbsp;content: "This is about referencing documents."
                            }
                            
                            // Comments stored separately
                            {
                                &nbsp;&nbsp;_id: ObjectId("comment1"),
                                &nbsp;&nbsp;post_id: ObjectId("postId1"),
                                &nbsp;&nbsp;user: "Alice",
                                &nbsp;&nbsp;text: "Nice post!",
                            }
                        </code>
                    </div>
                    <p>
                        Use Cases: Many-to-many or large one-to-many relationships. Frequently updated or accessed separately. Example: users and orders, courses and students.
                    </p>
                    <p>
                        Disadvantages: Slower reads (requires additional queries or $lookup). More complex queries. Requires careful management of references.
                    </p>
                </div>
                <div class="note-l2">
                    <h3>1. One-to-One (1:1)</h3>
                    <p>
                        One document in a collection is related to exactly one document in another collection. Preffered Embedded method in this.
                    </p>
                    <div class="code-container">
                        <code>
                            example:
                            //User and Profile (each user has one profile)
                            {
                                &nbsp;&nbsp;"_id": 1,
                                &nbsp;&nbsp;"name": "John",
                                &nbsp;&nbsp;"profile": {
                                    &nbsp;&nbsp;&nbsp;&nbsp;"age": 30,
                                    &nbsp;&nbsp;&nbsp;&nbsp;"gender": "male"
                                &nbsp;&nbsp;}
                            }

                            //mongoose schema for it:
                            const mongoose = require('mongoose');
                            
                            const userSchema = new mongoose.Schema({
                                name: String,
                                profile: {
                                    type: {
                                        age: Number,
                                        gender: String
                                    },
                                    _id: false // prevents _id in embedded profile
                                }
                            });
                        </code>
                    </div>
                    <div class="note-l3">
                        <h4>_id: false</h4>
                        <p>
                            In Mongoose, the option _id: false is used to prevent the automatic creation of an _id field in: Embedded (sub)documents, Arrays of subdocuments.
                        </p>
                    </div>
                </div>
                <div class="note-l2">
                    <h3>2. One-to-Many (1:N)</h3>
                    <p>
                        One document relates to many documents in another collection.
                    </p>
                    <p>
                        How to implement: Embed many documents (if limited and queried together) OR Reference array of ObjectIds (if large/queried separately)
                    </p>
                    <div class="note-l3">
                        <h4>2i. One-to-Few</h4>
                        <p>
                            A document is related to a small number of subdocuments (typically less than 10 or so). Preffered Embedding the related documents directly inside the main document.
                        </p>
                        <div class="code-container">
                            <code>
                                Example:
                                //A user has a few saved addresses
                                {
                                    &nbsp;&nbsp;"_id": 1,
                                    &nbsp;&nbsp;"name": "Walter",
                                    &nbsp;&nbsp;"addresses": [
                                        &nbsp;&nbsp;&nbsp;&nbsp;{ "type": "home", "city": "Chandigarh" },
                                        &nbsp;&nbsp;&nbsp;&nbsp;{ "type": "work", "city": "Mohali" }
                                    &nbsp;&nbsp;]
                                }

                                //mongoose schema for it:
                                const userSchema = new mongoose.Schema({
                                    &nbsp;&nbsp;name: String,
                                    &nbsp;&nbsp;addresses: [{
                                        &nbsp;&nbsp;&nbsp;&nbsp;type: {
                                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type: String,
                                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;city: String
                                        &nbsp;&nbsp;&nbsp;&nbsp;},
                                        &nbsp;&nbsp;&nbsp;&nbsp;_id: false // prevents _id in each address object
                                    &nbsp;&nbsp;}]
                                });
                            </code>
                        </div>
                    </div>
                    <div class="note-l3">
                        <h4>2ii. One-to-Many</h4>
                        <p>
                            A document is related to many other documents (dozens to thousands), but not a huge number. Preffered Referencing the related documents in a separate collection.
                        </p>
                        <div class="code-container">
                            <code>
                                Example:
                                //A blog post has many comments
                                //Blog Post:
                                {
                                    &nbsp;&nbsp;"_id": 1,
                                    &nbsp;&nbsp;"title": "NoSQL vs SQL",
                                    &nbsp;&nbsp;"author": "Walter"
                                }

                                //Comments:
                                { "_id": 101, "post_id": 1, "user": "Alice", "text": "Great post!" }
                                { "_id": 102, "post_id": 1, "user": "Bob", "text": "Thanks!" }

                                //Blogpost schema:
                                const mongoose = require('mongoose');
                                
                                const blogPostSchema = new mongoose.Schema({
                                    &nbsp;&nbsp;title: String,
                                    &nbsp;&nbsp;author: String
                                });                                
                                const BlogPost = mongoose.model('BlogPost', blogPostSchema);

                                //Comments schema:
                                const commentSchema = new mongoose.Schema({
                                    post_id: {
                                        &nbsp;&nbsp;type: mongoose.Schema.Types.ObjectId,
                                        &nbsp;&nbsp;ref: 'BlogPost' //same name as refrenced collection name
                                    },
                                    user: String,
                                    text: String
                                });
                                const Comment = mongoose.model('Comment', commentSchema);
                            </code>
                        </div>
                        <p>
                            <span class="bolder">type: Schema.Types.ObjectId - </span>It tells Mongoose: "This field stores an ObjectId" It's usually used to reference another document.
                        </p>
                        <p>
                            <span class="bolder">ref: 'ModelName' - </span> Specifies the name of the model being referenced — here, 'BlogPost'. This tells Mongoose which collection to look in when populating this reference.
                        </p>
                    </div>
                    <div class="note-l3">
                        <h4>2iii. One-to-Squillions</h4>
                        <p>
                            A document is related to a huge number of other documents (thousands to millions). Preffered foreign key-like references (e.g., post_id) in child documents not in parent documents.
                        </p>
                        <div class="code-container">
                            <code>
                                Example:
                                //A popular user with millions of followers
                                //User:
                                { "_id": 1, "username": "inderjit" }


                                //Followers Collection:
                                { "_id": 1001, "user_id": 1, "follower_id": 2001 }
                                { "_id": 1002, "user_id": 1, "follower_id": 2002 }
                                ...
                                { "_id": 999999, "user_id": 1, "follower_id": 9999 }


                                //User schema:
                                const userSchema = new mongoose.Schema({
                                    &nbsp;&nbsp;username: String
                                });
                                const User = mongoose.model('User', userSchema);

                                //Follower Schema (Normalized Design):
                                const followerSchema = new mongoose.Schema({
                                    &nbsp;&nbsp;user_id: {
                                        &nbsp;&nbsp;&nbsp;&nbsp;type: mongoose.Schema.Types.ObjectId,
                                        &nbsp;&nbsp;&nbsp;&nbsp;ref: 'User'
                                    &nbsp;&nbsp;},
                                    &nbsp;&nbsp;follower_id: {
                                        &nbsp;&nbsp;&nbsp;&nbsp;type: mongoose.Schema.Types.ObjectId,
                                        &nbsp;&nbsp;&nbsp;&nbsp;ref: 'User'
                                    &nbsp;&nbsp;}
                                });
                                const Follower = mongoose.model('Follower', followerSchema);


                                //here child has refrence of parent because that is efficient because of large number and this is best approach.
                            </code>
                        </div>
                    </div>
                </div>
                <div class="note-l2">
                    <h3>3. Many-to-Many (N:N)</h3>
                    <p>
                        Multiple documents in one collection relate to multiple documents in another collection.
                    </p>
                    <p>
                        Preferred to use array of references in each document (referencing) when data is accessed together and small in size, OR create a junction collection (embedding) when data is large.
                    </p>
                    <div class="code-container">
                        <code>
                            //example Students enrolled in many courses, and each course has many students.
                            //Reference Example:

                            //Student:
                            { "_id": 1, "name": "Inderjit", "courses": [101, 102] }

                            //course:
                            { "_id": 101, "title": "Math", "students": [1, 2] }


                            //Junction Collection (normalized) Example:
                            { "_id": 1, "student_id": 1, "course_id": 101 }
                            { "_id": 2, "student_id": 1, "course_id": 102 }
                        </code>
                    </div>
                </div>
                <div class="note-l2">
                    <h3>Population</h3>
                    <p>
                        Population refers to the process of automatically replacing references (ObjectIds) in documents with the actual referenced documents from another collection.
                    </p>
                    <p>
                        Replace the referenced _id fields in a document with the full document(s) from the related collection. It mimics the JOIN behavior in relational databases.
                    </p>
                    <div class="code-container">
                        <code>
                            //basic syntax:
                            Model.find(query).populate('fieldName');
                            
                            //fieldName is the name of the reference field in the schema.
                        </code>
                    </div>
                    <div class="code-container">
                        <code>
                            //example:
                            //schema of example:
                            const ProfileSchema = new mongoose.Schema({
                                &nbsp;&nbsp;bio: String,
                                &nbsp;&nbsp;age: Number
                            });
                            const UserSchema = new mongoose.Schema({
                                &nbsp;&nbsp;name: String,
                                &nbsp;&nbsp;profile: { type: mongoose.Schema.Types.ObjectId, ref: 'Profile' } //refrence
                            });


                            //Query and Populate:
                            User.findOne({ name: 'Inderjit' })
                                &nbsp;&nbsp;.populate('profile')
                                &nbsp;&nbsp;.then(user => {
                                    &nbsp;&nbsp;&nbsp;&nbsp;console.log(user);
                            });
                            //Mongoose will automatically fetch the profile document and insert it in place of the _id.


                            //result without popular if we print data:
                            {
                                &nbsp;&nbsp;"_id": "u1",
                                &nbsp;&nbsp;"name": "Inderjit",
                                &nbsp;&nbsp;"profile": "p1" //refrenced id of other document
                            }


                            //result with population when we print data:
                            {
                                &nbsp;&nbsp;"_id": "u1",
                                &nbsp;&nbsp;"name": "Inderjit",
                                &nbsp;&nbsp;"profile": {
                                    &nbsp;&nbsp;&nbsp;&nbsp;"_id": "p1",
                                    &nbsp;&nbsp;&nbsp;&nbsp;"bio": "Student of CSE",
                                    &nbsp;&nbsp;&nbsp;&nbsp;"age": 21
                                &nbsp;&nbsp;}
                            }

                            //Now the profile field contains the full document, not just the ID.
                        </code>
                    </div>
                </div>
                <div class="note-l2">
                    <h3>6 Rules of Thumb for MongoDB Schema Design</h3>
                    <p>
                        <ul>
                            <li>Structure your schema around how your app reads and writes data for better performance.</li>
                            <li>Embed small, related data inside documents when it's always accessed with the parent.</li>
                            <li>Use references when data is large, reused in many places, or frequently updated.</li>
                            <li>Avoid embedding arrays that can grow endlessly to prevent hitting the document size limit.</li>
                            <li>Use TTL indexes or capped collections to manage and expire time-based or log data.</li>
                            <li>Design using rich documents that reflect real-world entities instead of normalizing like SQL.</li>
                            <li>You can read it in official website of MongoDB in detail</li>
                        </ul>
                    </p>
                </div>
            </div>
        </section>


        <!-- Schema Validations -->
        <section id="section17" class="note-section" tabindex="0">
            <div class="note-l1">
                <h2>Deletion in Relationships</h2>
                <p>
                    Handling deletion in relationships in MongoDB with Mongoose is important to maintain data consistency. Here are the common strategies, especially when documents are referenced (not embedded).
                </p>
                <p>
                    <span class="bolder">Cascade Delete - </span> Cascade delete means: When a parent document is deleted, its related child documents (in other collections) are automatically deleted.
                </p>
                <p>
                    We can handle deletion in relationships using Mongoose middlewares. Pre Middleware - Runs before the event. Post Middleware - Runs after the event.
                </p>
                <div class="code-container">
                    <code>
                        //example syntax of post middleware:
                        schema.post('operation', async function (doc) {
                            &nbsp;&nbsp;// Your logic here
                        });
                    </code>
                </div>
                <div class="code-container">
                    <code>
                        //example:
                        //A customer has many orders, When a customer is deleted, all its orders should also be removed.

                        //Add Post Middleware for Cascade Delete like this:

                        customerSchema.post("findOneAndDelete", async (customer) => { //using post
                            &nbsp;&nbsp;if (customer.orders.length) {
                                &nbsp;&nbsp;&nbsp;&nbsp;let res = await Order.deleteMany({ _id: { $in: customer.orders } });
                                &nbsp;&nbsp;&nbsp;&nbsp;console.log("Deleted orders:", res);
                            &nbsp;&nbsp;}
                        });


                        //example schema code:
                        // Order Schema
                        const orderSchema = new mongoose.Schema({
                            &nbsp;&nbsp;item: String,
                            &nbsp;&nbsp;amount: Number,
                        });
                        const Order = mongoose.model('Order', orderSchema);

                        // Customer Schema
                        const customerSchema = new mongoose.Schema({
                            &nbsp;&nbsp;name: String,
                            &nbsp;&nbsp;orders: [{ type: mongoose.Schema.Types.ObjectId, ref: 'Order' }],
                        });
                        const Customer = mongoose.model('Customer', customerSchema);

                        //lets there is some data is also there

                        //Now Delete the Customer (regular way):
                        await Customer.findOneAndDelete({ _id: customer._id });
                        //This triggers the middleware and deletes all their orders
                    </code>
                </div>
                <p>
                    We can also learn about different mongoose middlewares like for find, save, delete e.t.c...
                </p>
            </div>
        </section>

    </main>

    <script>
        // Toggle sidebar for mobile
        const menuToggle = document.querySelector('.menu-toggle');
        const sidebar = document.querySelector('.sidebar');

        menuToggle.addEventListener('click', () => {
            sidebar.classList.toggle('active');
        });
    </script>
</body>

</html>




















































<!-- MongoDB  -->
<template>
    <section id="section1" class="note-section" tabindex="0">
        <!-- lvl 1 -->
        <div class="note-l1">
            <h2>Node.js Basics</h2>
            <p>
                Essential concepts and methods for building server-side applications with Node.js.
            </p>
            <!-- lvl 2  -->
            <div class="note-l2">
                <h3>require()</h3>
                <p>
                    Import modules or files into your Node.js application.
                </p>
                <div class="code-container">
                    <code>
                        Syntax:
                        const module = require('module-name');
                        // Imports a module
                    </code>
                </div>
                <!-- lvl 3  -->
                <div class="note-l3">
                    <h4>Example:</h4>
                    <p>
                        Importing the built-in 'fs' module to work with the file system.
                    </p>
                    <div class="code-container">
                        <code>
                            const fs = require('fs');
                            // Use fs to read/write files
                        </code>
                    </div>
                </div>
            </div>
            <!-- table -->
            <table>
                <caption>Node.js Module Types</caption>
                <thead>
                    <tr>
                        <th>Module Type</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Core Modules</td>
                        <td>Built-in modules provided by Node.js (e.g., fs, http).</td>
                    </tr>
                    <tr>
                        <td>Local Modules</td>
                        <td>Modules created within your project.</td>
                    </tr>
                    <tr>
                        <td>Third-Party Modules</td>
                        <td>Modules installed via npm (e.g., express).</td>
                    </tr>
                </tbody>
            </table>
            <ol>
                <li>Asynchronous and Event-Driven</li>
                <li>Single-Threaded but Highly Scalable</li>
                <li>Fast Execution with V8 Engine</li>
                <li>Open-source and Community Driven
                    <ul>
                        <li>asfa</li>
                    </ul>
                </li>
            </ol>
        </div>
    </section>
    <section id="section1" class="note-section" tabindex="0">
        <!-- lvl 1 -->
        <div class="note-l1">
            <h2>Node.js Basics</h2>
            <p>
                Essential concepts and methods for building server-side applications with Node.js.
            </p>
        </div>
        <div class="note-l2">
            <h3>require()</h3>
            <p>
                Import modules or files into your Node.js application.
            </p>
            <div class="code-container">
                <code>
                    Syntax:
                    const module = require('module-name');
                    // Imports a module
                </code>
            </div>
        </div>
        <div class="note-l3">
            <h4>Example:</h4>
            <p>
                Importing the built-in 'fs' module to work with the file system.
            </p>
            <div class="code-container">
                <code>
                    const fs = require('fs');
                    // Use fs to read/write files
                </code>
            </div>
        </div>
    </section>
</template>